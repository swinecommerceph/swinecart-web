{"version":3,"sources":["filter.js","viewProducts_script.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"viewProducts.js","sourcesContent":["'use strict';\n\nvar filter = {\n    apply: function(){\n        // URL search syntax: ?q=value&type=value[+value]*&breed=value[+value]&sort=value*\n        var types = [];\n        var breeds = [];\n        var filter_parameters = '?';\n        var search_query = document.getElementById('search').value;\n        var type_url = '';\n        var breed_url = '';\n\n        // Get all checked checkboxes regarding type of product\n        $('.filter-type:checked').each(function(){\n            types.push($(this).attr('data-type'));\n        });\n\n        // Get all checked checkboxes regarding breed of product\n        $('.filter-breed:checked').each(function(){\n            breeds.push($(this).attr('data-breed'));\n        });\n\n        // Check if there is search query\n        if(search_query){\n            filter_parameters += 'q=' + search_query;\n        }\n\n        // Join type filter values by '+' and append to filter_parameters\n        if(types.length > 0){\n            type_url = 'type=';\n            type_url += types.join('+');\n            filter_parameters += (filter_parameters.length > 1) ? '&'+type_url : type_url;\n        }\n\n        // Join breed filter values by '+' and append to filter_parameters\n        if(breeds.length > 0){\n            breed_url = 'breed=';\n            breed_url += breeds.join('+');\n            filter_parameters += (filter_parameters.length > 1) ? '&'+breed_url : breed_url;\n        }\n\n        // Append sort parameters to filter_parameters\n        if($('select option:selected').val() == \"\"){\n            filter_parameters += (filter_parameters.length > 1) ? '&sort=none' : 'sort=none';\n        }\n        else {\n            filter_parameters += (filter_parameters.length > 1) ? '&sort='+$('select option:selected').val() : 'sort='+$('select option:selected').val();\n        }\n        window.location = config.viewProducts_url+filter_parameters;\n\n    }\n};\n","$(document).ready(function(){\n\n    var chips = '';\n\n    // Setup Elasticsearch\n    var client = new $.es.Client({\n        hosts: window.elasticsearchHost\n    });\n\n    $('#search-results').width($('#search-field').width());\n\n    // Find all ticked checkboxes for producing chips\n    if($('input:checked').length > 0) chips += 'Filtered by: ';\n    $('input:checked').each(function(){\n        if($(this).attr('data-type')){\n            chips +=\n                '<div class=\"chip\" style=\"text-transform:capitalize;\">'+\n                    'Type: '+$(this).attr('data-type')+\n                    '<i class=\"close material-icons\" data-checkbox-id=\"'+$(this).attr('id')+'\">close</i>'+\n                '</div> ';\n        }\n        else if ($(this).attr('data-breed')) {\n            chips +=\n                '<div class=\"chip\" style=\"text-transform:capitalize;\">'+\n                    'Breed: '+$(this).attr('data-breed')+\n                    '<i class=\"close material-icons\" data-checkbox-id=\"'+$(this).attr('id')+'\">close</i>'+\n                '</div> ';\n        }\n\n    });\n\n    // Append chip to #chip-container\n    $('#chip-container').append(chips);\n\n    // For Filter Container Pushpin\n    $('#filter-container #collapsible-container').pushpin({\n        top: $('#filter-container').offset().top,\n        offset: 135\n    });\n\n    $(\"input#search\").keydown(function(e){\n        // Perform GET request upon pressing the Enter key\n        // or fetch suggestions from Elastic search\n        // and output it on search results\n        if(e.which == 13) {\n            e.preventDefault();\n            filter.apply();\n        }\n        else{\n            setTimeout(function(){\n                var searchPhrase = $('input#search').val();\n\n                // Execute of searchPhrase is not empty\n                if(searchPhrase){\n\n                    // Query on Elasticsearch search engine\n                    client.search({\n                        index: 'swinecart',\n                        type: 'products',\n                        body:{\n                            \"_source\": \"output\",\n                            \"suggest\": {\n                                \"productSuggest\": {\n                                    \"prefix\": searchPhrase,\n                                    \"completion\": {\n                                        \"field\": \"suggest\",\n                                        \"fuzzy\": {\n                                        \t\"fuzziness\": 2\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }).then(function(response){\n                        var options = (response.suggest) ? response.suggest.productSuggest[0].options : '';\n                        var searchResultsTop = '';\n                        var searchResultsBot = '';\n\n                        if(options.length > 0){\n\n                            for (var i = 0; i < 3; i++) {\n                                searchResultsTop += '<li class=\"search-item\">' +\n                                    options[i]._source.output[1] +\n                                    '</li>';\n\n                                searchResultsBot += '<li class=\"search-item\">' +\n                                    options[i]._source.output[0] +\n                                    '</li>';\n                            }\n\n                            $(\"#search-results ul\").html(searchResultsTop + searchResultsBot);\n\n                            $(\"#search-results\").show();\n                        }\n\n                    }, function(error){\n                        console.trace(error.message);\n                    });\n                }\n\n                else $(\"#search-results\").hide();\n\n            }, 0);\n\n        }\n    });\n\n    // Redirect to designated link upon checkbox and select value change\n    $(\"#filter-container input[type=checkbox], select\").change(function(){\n        filter.apply();\n    });\n\n    // Redirect to designated link upon removing chips\n    $(\".chip i.material-icons\").click(function(e){\n        e.preventDefault();\n        $(\"#\"+$(this).attr('data-checkbox-id')).prop('checked', false);\n        filter.apply();\n    });\n\n    $('body').on('click', 'li.search-item', function(e){\n        e.preventDefault();\n\n        $('input#search').val($(this).html());\n\n        $(\"#search-results\").hide();\n        filter.apply();\n    });\n\n});\n"]}